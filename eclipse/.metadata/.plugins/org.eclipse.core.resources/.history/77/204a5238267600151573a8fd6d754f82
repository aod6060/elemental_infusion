package com.derf.ei.item;

import net.minecraft.block.Block;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.util.ChatComponentText;
import net.minecraft.world.World;

import com.derf.ei.EIType;
import com.derf.ei.Main;
import com.derf.ei.block.EIBlockVoidStone;
import com.derf.ei.block.EIBlocks;

public class EIItemDust extends Item {
	private EIType type;
	
	public EIItemDust(String name, EIType type) {
		super();
		
		this.setUnlocalizedName(name);
		
		this.setTextureName(Main.MODID + ":" + name);
		
		this.type  = type;
	}
	
	public EIType getType() {
		return type;
	}

	@Override
	public boolean onItemUse(
			ItemStack itemStack, 
			EntityPlayer player,
			World world, 
			int x, 
			int y, 
			int z,
			int side, 
			float fx, 
			float fy,
			float fz) {
		
		if(!world.isRemote) {
			Block[] blocks = new Block[11];
			
			boolean b = true;
			
			blocks[0] = getBlock(world, x, y, z);
			blocks[1] = getBlock(world, x, y-1, z);
			blocks[2] = getBlock(world, x, y-2, z);
			blocks[3] = getBlock(world, x-1, y-2, z);
			blocks[4] = getBlock(world, x+1, y-2, z);
			blocks[5] = getBlock(world, x, y-2, z-1);
			blocks[6] = getBlock(world, x, y-2, z+1);
			blocks[7] = getBlock(world, x-1, y-2, z-1);
			blocks[8] = getBlock(world, x+1, y-2, z-1);
			blocks[9] = getBlock(world, x+1, y-2, z+1);
			blocks[10] = getBlock(world, x-1, y-2, z+1);
			
			for(int i = 0; i < blocks.length; i++) {
				
				if(!isVoidStone(blocks[i])) {
					b = false;
					break;
				}
			}
			
			if(!b) {
				player.addChatComponentMessage(new ChatComponentText("Need to right click the top of the totum with dust to activate it."));
				return false;
			}
			
			
			if(this.type == EIType.FIRE) {
				setBlock(EIBlocks.fireTotumHead, world, x, y, z);
			} else if(this.type == EIType.WATER) {
				setBlock(EIBlocks.waterTotumHead, world, x, y, z);
			} else if(this.type == EIType.AIR) {
				setBlock(EIBlocks.airTotumHead, world, x, y, z);
			} else if(this.type == EIType.EARTH) {
				setBlock(EIBlocks.earthTotumHead, world, x, y, z);
			}
			
			setBlock(EIBlocks.totum, world, x, y-1, z);
			setBlock(EIBlocks.totum, world, x, y-2, z);
			setBlock(EIBlocks.totum, world, x-1, y-2, z);
			setBlock(EIBlocks.totum, world, x+1, y-2, z);
			setBlock(EIBlocks.totum, world, x, y-2, z-1);
			setBlock(EIBlocks.totum, world, x, y-2, z+1);
			setBlock(EIBlocks.totum, world, x-1, y-2, z-1);;
		}
		
		return true;
	}
	
	private boolean isVoidStone(Block block) {
		return block instanceof EIBlockVoidStone;
	}
	
	private Block getBlock(World world, int x, int y, int z) {
		return world.getBlock(x, y, z);
	}
	
	private void setBlock(Block block, World world, int x, int y, int z) {
		world.setBlock(x, y, z, block);
	}
}
