package com.derf.ei.tileentity;

import net.minecraft.block.Block;
import net.minecraft.tileentity.TileEntity;

import com.derf.ei.block.EIBlockVoidStone;
import com.derf.ei.block.EIBlocks;

public class EITileEntityFireTotem extends EITileEntityTotem {

	Block[] blocks = new Block[10];
	
	@Override
	public void updateEntity() {
		// TODO Auto-generated method stub
		super.updateEntity();
		this.checkMultiBlock(); 
	}
	
	private void checkMultiBlock() {
		boolean isMultiBlock = true;
		
		blocks[0] = worldObj.getBlock(this.xCoord, this.yCoord-1, this.zCoord);
		blocks[1] = worldObj.getBlock(this.xCoord, this.yCoord-2, this.zCoord);
		blocks[2] = worldObj.getBlock(this.xCoord-1, this.yCoord-2, this.zCoord);
		blocks[3] = worldObj.getBlock(this.xCoord+1, this.yCoord-2, this.zCoord);
		blocks[4] = worldObj.getBlock(this.xCoord, this.yCoord-2, this.zCoord-1);
		blocks[5] = worldObj.getBlock(this.xCoord, this.yCoord-2, this.zCoord+1);
		blocks[6] = worldObj.getBlock(this.xCoord-1, this.yCoord-2, this.zCoord-1);
		blocks[7] = worldObj.getBlock(this.xCoord+1, this.yCoord-2, this.zCoord-1);
		blocks[8] = worldObj.getBlock(this.xCoord+1, this.yCoord-2, this.zCoord+1);
		blocks[9] = worldObj.getBlock(this.xCoord-1, this.yCoord-2, this.zCoord+1);
		
		for(int i = 0; i < blocks.length; i++) {
			
			if(!isVoidStoneTotem(blocks[i])) {
				isMultiBlock = false;
				break;
			}
		}
		
		
		if(!isMultiBlock) {
			changeBack(xCoord, yCoord, zCoord);
		} else {
			changeTo(xCoord, yCoord, zCoord);
		}
	}
	


	private boolean isVoidStoneTotem(Block block) {
		return block.getUnlocalizedName().equals("tile.totum") || block.getUnlocalizedName().equals("tile.void_stone");
	}
	
	private boolean isTotem(Block block) {
		return block.getUnlocalizedName().equals("tile.totum");
	}
	
	private void changeBack(int x, int y, int z) {
		if(isVoidStoneTotem(blocks[0])) {
			worldObj.setBlock(x, y-1, z, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[1])) {
			worldObj.setBlock(x, y-2, z, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[2])) {
			worldObj.setBlock(x-1, y-2, z, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[3])) {
			worldObj.setBlock(x+1, y-2, z, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[4])) {
			worldObj.setBlock(x, y-2, z-1, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[5])) {
			worldObj.setBlock(x, y-2, z+1, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[6])) {
			worldObj.setBlock(x-1, y-2, z-1, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[7])) {
			worldObj.setBlock(x+1, y-2, z-1, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[8])) {
			worldObj.setBlock(x+1, y-2, z+1, EIBlocks.voidStone);
		}
		
		if(isVoidStoneTotem(blocks[9])) {
			worldObj.setBlock(x-1, y-2, z+1, EIBlocks.voidStone);
		}
	}	
	
	private void changeTo(int x, int y, int z) {
		if(!isTotem(blocks[0])) {
			worldObj.setBlock(x, y-1, z, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[1])) {
			worldObj.setBlock(x, y-2, z,EIBlocks.totum);
		}
		
		if(!isTotem(blocks[2])) {
			worldObj.setBlock(x-1, y-2, z, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[3])) {
			worldObj.setBlock(x+1, y-2, z, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[4])) {
			worldObj.setBlock(x, y-2, z-1, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[5])) {
			worldObj.setBlock(x, y-2, z+1, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[6])) {
			worldObj.setBlock(x-1, y-2, z-1,EIBlocks.totum);
		}
		
		if(!isTotem(blocks[7])) {
			worldObj.setBlock(x+1, y-2, z-1, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[8])) {
			worldObj.setBlock(x+1, y-2, z+1, EIBlocks.totum);
		}
		
		if(!isTotem(blocks[9])) {
			worldObj.setBlock(x-1, y-2, z+1, EIBlocks.totum);
		}
	}
}
